!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.BaaS=t():e.BaaS=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=52)}([function(e,t,r){(function(t){var n=t.BaaS||{};n._config=r(16),n._polyfill=r(17),n.use=function(e){return e(n)},e.exports=n}).call(this,r(14))},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Error;return n.code=t,n.message=r?"".concat(t,": ").concat(r):"".concat(t,": ").concat(this.mapErrorMessage(t)),n}var t,n,o;return t=e,(n=[{key:"mapErrorMessage",value:function(e){switch(e){case 600:return"network disconnected";case 601:return"request timeout";case 602:return"uninitialized";case 603:return"unauthorized";case 604:return"session missing";case 605:return"incorrect parameter type";case 607:return"payment cancelled";case 608:return"payment failed";case 609:return"wxExtend function should be executed to allow plugin use wx.login, wx.getUserInfo, wx.requestPayment";case 610:return"errorTracker uninitialized";case 611:return"unsupported function";default:return"unknown error"}}}])&&r(t.prototype,n),o&&r(t,o),e}();e.exports=n},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=r(4),i=r(3),a=r(0),u=r(1);Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),n=r.length>>>0;if(0===n)return!1;var o,i,a=0|t,u=Math.max(a>=0?a:n-Math.abs(a),0);for(;u<n;){if((o=r[u])===(i=e)||"number"==typeof o&&"number"==typeof i&&isNaN(o)&&isNaN(i))return!0;u++}return!1}});var c=function(e,t){for(var r in t=t||{}){var n=new RegExp(":"+r,"g");e=e.replace(n,t[r])}return e.replace(/([^:])\/\//g,function(e,t){return t+"/"})},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=a._config.REQUEST_PARAMS_MAP,r=y({},e);return Object.keys(e).map(function(n){Object.keys(t).map(function(o){if(n.startsWith(o)){var i=n.replace(o,t[o]);delete r[n],r[i]=e[n]}})}),r},f=function(e){var t="";return 404===e.statusCode?t="not found":e.data.error_msg?t=e.data.error_msg:e.data.message&&(t=e.data.message),t},l=function(e){return"[object Array]"===Object.prototype.toString.call(e)},y=function(){return Object.assign.apply(Object,arguments)},h=function e(t){if(null==t)return Object.create(null);var r=l(t)?[]:Object.create(Object.getPrototypeOf(t));for(var o in t)t.hasOwnProperty(o)&&(t[o]&&"object"===n(t[o])?(r[o]=l(t[o])?[]:{},r[o]=e(t[o])):r[o]=t[o]);return r};var p=function(e,t){return e.replace(/:(\w*)/g,function(e,r){void 0!==t[r]&&delete t[r]}),t};e.exports={mergeRequestHeader:function(e){var t={"X-Hydrogen-Client-ID":a._config.CLIENT_ID,"X-Hydrogen-Client-Version":a._config.VERSION,"X-Hydrogen-Client-Platform":a._polyfill.CLIENT_PLATFORM,"X-Hydrogen-Client-SDK-Type":a._polyfill.SDK_TYPE},r=a.getAuthToken();return r&&(t.Authorization=a._config.AUTH_PREFIX+" "+r),y({},e||{},t)},log:function(e){console.log("BaaS LOG: "+e)},format:c,getSysPlatform:function(){var e="UNKNOWN";try{e=a._polyfill.getSystemInfoSync().platform}catch(e){}return e},getFileNameFromPath:function(e){var t=e.lastIndexOf("/");return e.slice(t+1)},parseRegExp:function(e){var t=[],r=e.toString(),n=r.lastIndexOf("/");return t.push(r.substring(1,n)),n!==r.length-1&&t.push(r.substring(n+1)),t},replaceQueryParams:s,extractErrorMsg:f,isArray:l,isString:function(e){return"[object String]"===Object.prototype.toString.call(e)},isObject:function(e){var t=n(e);return null!=e&&"object"==t},isFunction:function(e){var t=n(e);return null!=e&&"function"==t},extend:y,cloneDeep:h,isSessionExpired:function(){return Date.now()/1e3>=(o.get(i.STORAGE_KEY.EXPIRES_AT)||0)},excludeParams:p,doCreateRequestMethod:function(e){for(var t in e)e.hasOwnProperty(t)&&(a[t]=function(t){var r=e[t];return function(e){var t=h(e),n=r.method||"GET";if(r.defaultParams){var o=h(r.defaultParams);t=y(o,t)}var i=c(r.url,t),u={};return t.data?u=t.data:(u=p(r.url,t),u=s(u)),a._baasRequest({url:i,method:n,data:u})}}(t))},validateStatusCode:function(e){var t=parseInt(e.status||e.statusCode);if(t>=200&&t<300)return e;throw new u(t,f(e))},rateLimit:function(e){var t=null;return function(){return t||(t=e.apply(this,arguments).then(function(e){return t=null,e},function(e){throw t=null,e})),t}}}},function(e,t){e.exports={STORAGE_KEY:{AUTH_TOKEN:"auth_token",USERINFO:"userinfo",UID:"uid",OPENID:"openid",UNIONID:"unionid",IS_LOGINED_BAAS:"is_logined_baas",IS_ANONYMOUS_USER:"is_anonymous_user",EXPIRES_AT:"session_expires_at",ALIPAY_USER_ID:"alipay_user_id"},STATUS_CODE:{CREATED:201,SUCCESS:200,UPDATE:200,PATCH:200,DELETE:204,UNAUTHORIZED:401,NOT_FOUND:404,SERVER_ERROR:500},UPLOAD:{UPLOAD_FILE_KEY:"file",HEADER_AUTH:"Authorization",HEADER_CLIENT:"X-Hydrogen-Client-ID",HEADER_AUTH_VALUE:"Hydrogen-r1 ",UA:"Mozilla/5.0 (Linux; U; Android 4.0.3; ko-kr; LG-L160L Build/IML74K) AppleWebkit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30"},USER_PROFILE_BUILD_IN_FIELDS:["id","created_at","created_by","updated_at","country","nickname","province","city","language","openid","unionid","avatar","is_authorized","gender"],httpMethodCodeMap:{GET:200,POST:201,PUT:200,PATCH:200,DELETE:204}}},function(e,t,r){var n=r(0);e.exports={set:function(e,t){n._polyfill.setStorageSync("ifx_baas_"+e,t)},get:function(e){return n._polyfill.getStorageSync("ifx_baas_"+e)}}},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(1),i=r(6),a=r(2),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._initQueryParams()}var t,r,u;return t=e,(r=[{key:"_initQueryParams",value:function(){this._queryObject={},this._limit=20,this._offset=0,this._orderBy=null,this._keys=null,this._expand=null}},{key:"setQuery",value:function(e){if(!(e instanceof i))throw new o(605);return this._queryObject=a.cloneDeep(e.queryObject),this}},{key:"select",value:function(e){return e instanceof Array?this._keys=e.join(","):this._keys=e,this}},{key:"expand",value:function(e){return e instanceof Array?this._expand=e.join(","):this._expand=e,this}},{key:"limit",value:function(e){if(!Number.isInteger(e))throw new o(605);return this._limit=e,this}},{key:"offset",value:function(e){if(!Number.isInteger(e))throw new o(605);return this._offset=e,this}},{key:"orderBy",value:function(e){return e instanceof Array?this._orderBy=e.join(","):this._orderBy=e,this}},{key:"_handleAllQueryConditions",value:function(){var e={};return e.limit=this._limit,e.offset=this._offset,this._orderBy&&(e.order_by=this._orderBy),this._keys&&(e.keys=this._keys),this._expand&&(e.expand=this._expand),e.where=JSON.stringify(this._queryObject),e}}])&&n(t.prototype,r),u&&n(t,u),e}();e.exports=u},function(e,t,r){function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(8),a=r(10),u=r(1),c=r(2),s=r(7)._serializeValueFuncFactory(["BaseRecord"]),f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.queryObject={}}var t,r,f;return t=e,f=[{key:"and",value:function(){for(var t=new e,r={$and:[]},n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.forEach(function(e){r.$and.push(e.queryObject)}),t._setQueryObject(r),t}},{key:"or",value:function(){for(var t=new e,r={$or:[]},n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.forEach(function(e){r.$or.push(e.queryObject)}),t._setQueryObject(r),t}}],(r=[{key:"compare",value:function(e,t,r){var o="eq";switch(t){case"=":o="eq";break;case"!=":o="ne";break;case"<":o="lt";break;case"<=":o="lte";break;case">":o="gt";break;case">=":o="gte";break;default:throw new u(605)}return this._addQueryObject(e,n({},o,s(r))),this}},{key:"contains",value:function(e,t){if(t&&c.isString(t))return this._addQueryObject(e,{contains:t}),this;throw new u(605)}},{key:"matches",value:function(e,t){if(t&&t instanceof RegExp){var r=c.parseRegExp(t);return r.length>1?this._addQueryObject(e,{regex:r[0],options:r[1]}):this._addQueryObject(e,{regex:r[0]}),this}throw new u(605)}},{key:"in",value:function(e,t){if(t&&t instanceof Array)return this._addQueryObject(e,{in:t.map(function(e){return s(e)})}),this;throw new u(605)}},{key:"notIn",value:function(e,t){if(t&&t instanceof Array)return this._addQueryObject(e,{nin:t.map(function(e){return s(e)})}),this;throw new u(605)}},{key:"arrayContains",value:function(e,t){if(t&&t instanceof Array)return this._addQueryObject(e,{all:t}),this;throw new u(605)}},{key:"isNull",value:function(e){var t=this;return e&&e instanceof Array?e.forEach(function(e){t._addQueryObject(e,{isnull:!0})}):this._addQueryObject(e,{isnull:!0}),this}},{key:"isNotNull",value:function(e){var t=this;return e&&e instanceof Array?e.forEach(function(e){t._addQueryObject(e,{isnull:!1})}):this._addQueryObject(e,{isnull:!1}),this}},{key:"exists",value:function(e){var t=this;return e&&e instanceof Array?e.forEach(function(e){t._addQueryObject(e,{exists:!0})}):this._addQueryObject(e,{exists:!0}),this}},{key:"notExists",value:function(e){var t=this;return e&&e instanceof Array?e.forEach(function(e){t._addQueryObject(e,{exists:!1})}):this._addQueryObject(e,{exists:!1}),this}},{key:"include",value:function(e,t){if(t&&t instanceof i)return this._addQueryObject(e,{intersects:t.toGeoJSON()}),this;throw new u(605)}},{key:"within",value:function(e,t){if(t&&t instanceof a)return this._addQueryObject(e,{within:t.toGeoJSON()}),this;throw new u(605)}},{key:"withinCircle",value:function(e,t,r){if(t&&t instanceof i){var n={radius:r,coordinates:[t.longitude,t.latitude]};return this._addQueryObject(e,{center:n}),this}throw new u(605)}},{key:"withinRegion",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t&&t instanceof i){var o={geometry:t.toGeoJSON(),min_distance:n};return r&&(o.max_distance=r),this._addQueryObject(e,{nearsphere:o}),this}throw new u(605)}},{key:"hasKey",value:function(e,t){if("string"!=typeof e||"string"!=typeof t)throw u(605);return this._addQueryObject(e,{has_key:t}),this}},{key:"_setQueryObject",value:function(e){this.queryObject=e}},{key:"_addQueryObject",value:function(e,t){if(t.constructor!==Object)throw new u(605);var r=n({},e,{});Object.keys(t).forEach(function(n){r[e]["$".concat(n)]=t[n]}),this.queryObject.$and||(this.queryObject.$and=[]),this.queryObject.$and.push(r)}}])&&o(t.prototype,r),f&&o(t,f),e}();e.exports=f},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(1);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["BaseRecord"],t=r(8),n=r(10);return function(r){return e.includes("Geo")&&(r instanceof t||r instanceof n)?r.toGeoJSON():e.includes("BaseRecord")&&r instanceof u?null==r._recordID?"":r._recordID.toString():r}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._recordID=t,this._recordValueInit()}var t,r,u;return t=e,(r=[{key:"_recordValueInit",value:function(){this._record={$set:{},$unset:{}}}},{key:"set",value:function(){for(var e=this,t=a(["BaseRecord","Geo"]),r=a(["Geo"]),o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];if(1===u.length){if("object"!==n(u[0]))throw new i(605);var s=u[0],f={};Object.keys(u[0]).forEach(function(n){if(e._record.$unset.hasOwnProperty(n))throw new i(605);var o=s[n];Array.isArray(o)?f[n]=o.map(function(e){return r(e)}):f[n]=t(o)}),this._record.$set=f}else{if(2!==u.length)throw new i(605);if(this._record.$unset.hasOwnProperty(u[0]))throw new i(605);var l=u[1];Array.isArray(l)?this._record.$set[u[0]]=l.map(function(e){return r(e)}):this._record.$set[u[0]]=t(l)}return this}},{key:"unset",value:function(){for(var e=this,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];if("object"===n(r[0])){var a={};Object.keys(r[0]).forEach(function(t){if(e._record.$set.hasOwnProperty(t))throw new i(605);a[t]=""}),this._record.$unset=a}else{if("string"!=typeof r[0])throw new i(605);if(this._record.$set.hasOwnProperty(r[0]))throw new i(605);this._record.$unset[r[0]]=""}return this}},{key:"incrementBy",value:function(e,t){return this._record.$set[e]={$incr_by:t},this}},{key:"append",value:function(e,t){var r=a(["Geo"]);return t instanceof Array||(t=[t]),t=t.map(function(e){return r(e)}),this._record.$set[e]={$append:t},this}},{key:"uAppend",value:function(e,t){var r=a(["Geo"]);return t instanceof Array||(t=[t]),t=t.map(function(e){return r(e)}),this._record.$set[e]={$append_unique:t},this}},{key:"remove",value:function(e,t){var r=a(["Geo"]);return t instanceof Array||(t=[t]),t=t.map(function(e){return r(e)}),this._record.$set[e]={$remove:t},this}},{key:"patchObject",value:function(e,t){if("[object Object]"!==Object.prototype.toString.call(t))throw new i(605);return this._record.$set[e]={$update:t},this}}])&&o(t.prototype,r),u&&o(t,u),e}();u._serializeValueFuncFactory=a,e.exports=u},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(2),i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.longitude=t,this.latitude=r,this.geoJSON={type:"Point",coordinates:[this.longitude,this.latitude]}}var t,r,i;return t=e,(r=[{key:"toGeoJSON",value:function(){return o.cloneDeep(this.geoJSON)}}])&&n(t.prototype,r),i&&n(t,i),e}();e.exports=i},,function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(8),i=r(1),a=r(2),u=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(t&&t instanceof Array))throw new i(605);if(t.length<4)throw new i(605);this.points=t,this.geoJSON={type:"Polygon",coordinates:[]}}var t,r,u;return t=e,(r=[{key:"toGeoJSON",value:function(){var e=[];return this.points.forEach(function(t){if(t instanceof o)e.push([t.longitude,t.latitude]);else{if(!(t instanceof Array&&2===t.length))throw new i(605);e.push(t)}}),this.geoJSON.coordinates=[e],a.cloneDeep(this.geoJSON)}}])&&n(t.prototype,r),u&&n(t,u),e}();e.exports=u},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=r(0),s=r(7),f=r(2),l=r(3).USER_PROFILE_BUILD_IN_FIELDS,y=r(1),h=c._config.API,p=(r(4),r(3),function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,a(t).call(this,e))}var r,n,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,s),r=t,(n=[{key:"update",value:function(){var e=f.cloneDeep(this._record);return this._recordValueInit(),c.updateUser({data:e.$set})}},{key:"linkWechat",value:function(){return c._polyfill.linkWechat?c._polyfill.linkWechat.apply(null,arguments):Promise.reject(new y(605,"linkWechat 方法未定义"))}},{key:"linkAlipay",value:function(){return c._polyfill.linkAlipay?c._polyfill.linkAlipay.apply(null,arguments):Promise.reject(new y(605,"linkAlipay 方法未定义"))}},{key:"updatePassword",value:function(e){var t=this,r=e.password,n=e.newPassword;return c._baasRequest({url:h.WEB.ACCOUNT_INFO,method:"PUT",data:{password:r,new_password:n}}).then(function(e){return t})}},{key:"updateEmail",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.email,n=t.password,o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).sendVerificationEmail,i=void 0!==o&&o;return c._baasRequest({url:h.WEB.ACCOUNT_INFO,method:"PUT",data:{email:r,password:n}}).then(function(t){return i&&e.requestEmailVerification(r),Object.assign(e._attribute,t.data),e})}},{key:"updateUsername",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.username,n=t.password;return c._baasRequest({url:h.WEB.ACCOUNT_INFO,method:"PUT",data:{username:r,password:n}}).then(function(t){return Object.assign(e._attribute,t.data),e})}},{key:"requestEmailVerification",value:function(){return c._baasRequest({url:h.WEB.EMAIL_VERIFY,method:"POST"})}},{key:"updateMobile",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&this.requestMobileVerification(e)}},{key:"requestMobileVerification",value:function(){}}])&&o(r.prototype,n),l&&o(r,l),t}());p.initCurrentUser=function(e){if(!f.isObject(e))return new y(605);var t=new p;return t._attribute=e,t.toJSON=function(){return this._attribute},t.get=function(e){return this._attribute[e]},Object.keys(e).forEach(function(r){("_"===r[0]||l.includes(r))&&(t[r]=e[r])}),t},e.exports=p},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=r(0),s=r(5),f=r(11),l=r(2),y=r(1),h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,a(t).call(this))}var r,n,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,s),r=t,(n=[{key:"get",value:function(e){var t={userID:e};return this._expand&&(t.expand=this._expand),this._keys&&(t.keys=this._keys),this._initQueryParams(),c.getUserDetail(t)}},{key:"getWithoutData",value:function(e){if(l.isString(e)||Number.isInteger(e))return new f(e);throw new y(605)}},{key:"getCurrentUserWithoutData",value:function(){return new f}},{key:"find",value:function(){var e=this._handleAllQueryConditions();return this._initQueryParams(),c.getUserList(e)}}])&&o(r.prototype,n),h&&o(r,h),t}();e.exports=h},function(e,t,r){var n=r(0),o=r(1),i=n._config.API;e.exports=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)throw new o(605);var a={function_name:e,sync:r};return void 0!==t&&(a.data=t),n._baasRequest({url:i.CLOUD_FUNCTION,method:"POST",data:a}).then(function(e){return e.data})}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n=r(0),o=r(3),i=r(1),a=r(4),u=r(2),c=r(11),s=r(12),f=n._config.API,l=function(){var e=a.get(o.STORAGE_KEY.UID);return e?(new s).get(e).then(function(e){var t=c.initCurrentUser(e.data);return t.user_id=e.data.id,t}):Promise.reject(new i(604))};e.exports={login:u.rateLimit(function(e){return n.request({url:f.WEB.LOGIN,method:"POST",data:e}).then(u.validateStatusCode).then(function(e){return a.set(o.STORAGE_KEY.UID,e.data.user_id),a.set(o.STORAGE_KEY.AUTH_TOKEN,e.data.token),a.set(o.STORAGE_KEY.EXPIRES_AT,Math.floor(Date.now()/1e3)+e.data.expires_in-30),l()})}),logout:function(){return n.request({url:f.LOGOUT,method:"POST"}).then(u.validateStatusCode).then(function(e){return n.clearSession(),e})},silentLogin:function(){return Promise.reject(new i(605,"silentLogin 方法未定义"))},anonymousLogin:function(){return Promise.resolve()},requestPasswordReset:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).email;return n.request({url:f.WEB.PASSWORD_RESET,method:"POST",data:{email:e}}).then(u.validateStatusCode)},register:u.rateLimit(function(e){return n.request({url:f.WEB.REGISTER,method:"POST",data:e}).then(u.validateStatusCode).then(function(e){return a.set(o.STORAGE_KEY.UID,e.data.user_id),a.set(o.STORAGE_KEY.AUTH_TOKEN,e.data.token),a.set(o.STORAGE_KEY.EXPIRES_AT,Math.floor(Date.now()/1e3)+e.data.expires_in-30),l()})}),currentUser:u.rateLimit(l)}},function(e,t){var r={LOGIN:"/hserve/v1.4/session/init/",AUTHENTICATE:"/hserve/v1.4/session/authenticate/",LOGOUT:"/hserve/v1/session/destroy/",PAY:"/hserve/v1/wechat/pay/order/",ORDER:"/hserve/v1/wechat/pay/order/:transactionID/",UPLOAD:"/hserve/v1/upload/",TEMPLATE_MESSAGE:"/hserve/v1/template-message-ticket/",DECRYPT:"/hserve/v1/wechat/decrypt/",WXACODE:"/hserve/v1.4/miniappcode/",CLOUD_FUNCTION:"/hserve/v1/cloud-function/job/",USER_DETAIL:"/hserve/v1.3/user/info/:userID/",USER_LIST:"/hserve/v1.3/user/info/",UPDATE_USER:"/hserve/v1.3/user/info/",TABLE_LIST:"/hserve/v1.9/table/",TABLE_DETAIL:"/hserve/v1.9/table/:tableID/",RECORD_LIST:"/hserve/v1.9/table/:tableID/record/",QUERY_RECORD_LIST:"/hserve/v1.9/table/:tableID/record/",CREATE_RECORD_LIST:"/hserve/v1.9/table/:tableID/record/?enable_trigger=:enable_trigger",RECORD_DETAIL:"/hserve/v1.9/table/:tableID/record/:recordID/",CREATE_RECORD:"/hserve/v1.9/table/:tableID/record/",UPDATE_RECORD:"/hserve/v1.9/table/:tableID/record/:recordID/",UPDATE_RECORD_LIST:"/hserve/v1.9/table/:tableID/record/?limit=:limit&offset=:offset&where=:where&enable_trigger=:enable_trigger",DELETE_RECORD:"/hserve/v1.9/table/:tableID/record/:recordID/",DELETE_RECORD_LIST:"/hserve/v1.9/table/:tableID/record/?limit=:limit&offset=:offset&where=:where&enable_trigger=:enable_trigger",LAGECY_CONTENT_LIST:"/hserve/v1/content/detail/",CONTENT_LIST:"/hserve/v1.3/content/detail/",CONTENT_GROUP_LIST:"/hserve/v1/content/group/",CONTENT_DETAIL:"/hserve/v1.3/content/detail/:richTextID/",CONTENT_GROUP_DETAIL:"/hserve/v1/content/category/",CONTENT_CATEGORY_LIST:"/hserve/v1/content/category/",CONTENT_CATEGORY_DETAIL:"/hserve/v1/content/category/:categoryID/",FILE_DETAIL:"/hserve/v1.3/uploaded-file/:fileID/",FILE_LIST:"/hserve/v1.3/uploaded-file/",DELETE_FILE:"/hserve/v1.3/uploaded-file/:fileID/",DELETE_FILES:"/hserve/v1.3/uploaded-file/",FILE_CATEGORY_DETAIL:"/hserve/v1.3/file-category/:categoryID/",FILE_CATEGORY_LIST:"/hserve/v1.3/file-category/",CENSOR_IMAGE:"/hserve/v1.7/censor-image/",CENSOR_MSG:"/hserve/v1.7/censor-msg/",SEND_SMS_CODE:"/hserve/v1.8/sms-verification-code/",VERIFY_SMS_CODE:"/hserve/v1.8/sms-verification-code/verify/",WEB:{REGISTER:"/hserve/v1/register/",LOGIN:"/hserve/v1/login/",EMAIL_VERIFY:"/hserve/v1/user/email-verify/",ACCOUNT_INFO:"/hserve/v1/user/account/",PASSWORD_RESET:"/hserve/v1/user/password/reset/",ANONYMOUS_LOGIN:"/hserve/v1/anonymous-login/"},ALIPAY:{SILENT_LOGIN:"/hserve/v1/idp/alipay/silent-login/",AUTHENTICATE:"/hserve/v1/idp/alipay/authenticate/",USER_ASSOCIATE:"/hserve/v1/idp/alipay/user-associate/"}},n=[{getUserInfo:{url:r.USER_DETAIL,defaultParams:{userID:""}},getUserDetail:{url:r.USER_DETAIL},getUserList:{url:r.USER_LIST},updateUser:{url:r.UPDATE_USER,method:"PUT"}},{getTableList:{url:r.TABLE_LIST},getTable:{url:r.TABLE_DETAIL},getRecordList:{url:r.RECORD_LIST},queryRecordList:{url:r.QUERY_RECORD_LIST},getRecord:{url:r.RECORD_DETAIL},createRecord:{url:r.CREATE_RECORD,method:"POST"},createRecordList:{url:r.CREATE_RECORD_LIST,method:"POST"},updateRecord:{url:r.UPDATE_RECORD,method:"PUT"},updateRecordList:{url:r.UPDATE_RECORD_LIST,method:"PUT"},deleteRecord:{url:r.DELETE_RECORD,method:"DELETE"},deleteRecordList:{url:r.DELETE_RECORD_LIST,method:"DELETE"}},{getContentList:{url:r.LAGECY_CONTENT_LIST},getContentList2:{url:r.CONTENT_LIST},getContent:{url:r.CONTENT_DETAIL},getContentGroupList:{url:r.CONTENT_GROUP_LIST},getContentGroup:{url:r.CONTENT_GROUP_DETAIL},getContentCategoryList:{url:r.CONTENT_CATEGORY_LIST},getContentCategory:{url:r.CONTENT_CATEGORY_DETAIL}},{getFileDetail:{url:r.FILE_DETAIL},getFileList:{url:r.FILE_LIST},deleteFile:{url:r.DELETE_FILE,method:"DELETE"},deleteFiles:{url:r.DELETE_FILES,method:"DELETE"},getFileCategoryDetail:{url:r.FILE_CATEGORY_DETAIL},getFileCategoryList:{url:r.FILE_CATEGORY_LIST},sendSmsCode:{url:r.SEND_SMS_CODE,method:"POST"},verifySmsCode:{url:r.VERIFY_SMS_CODE,method:"POST"}},{getOrderList:{url:r.PAY}}];e.exports={API_HOST:"https://api.myminapp.com",API:r,API_HOST_PATTERN:/^https:\/\/\w+\.myminapp\.com/,AUTH_PREFIX:"Hydrogen-r1",METHOD_MAP_LIST:n,DEBUG:!1,RANDOM_OPTION:{max:100},REQUEST_PARAMS_MAP:{contentGroupID:"content_group_id",categoryID:"category_id",recordID:"id",submissionType:"submission_type",submissionValue:"submission_value",categoryName:"category_name"},VERSION:"v2.0.0"}},function(e,t,r){e.exports={wxLogin:function(){var e;return(e=wx).login.apply(e,arguments)},wxGetUserInfo:function(){var e;return(e=wx).getUserInfo.apply(e,arguments)},wxPaymentRequest:function(){var e;return(e=wx).requestPayment.apply(e,arguments)},getAPIHost:function(){return"https://".concat(r(0)._config.CLIENT_ID,".myminapp.com")},SDK_TYPE:"file",CLIENT_PLATFORM:"WECHAT",setStorageSync:function(e,t){return wx.setStorageSync(e,t)},getStorageSync:function(e){return wx.getStorageSync(e)},getSystemInfoSync:function(){return wx.getSystemInfoSync()}}},function(e,t,r){var n=r(3),o=r(4),i=r(1),a=r(2);e.exports=function(e){e.init=function(t){if(!a.isString(t))throw new i(605);e._config.CLIENT_ID=t,e._config.API_HOST=e._polyfill.getAPIHost(t)},e.getAuthToken=function(){return o.get(n.STORAGE_KEY.AUTH_TOKEN)},e.clearSession=function(){o.set(n.STORAGE_KEY.AUTH_TOKEN,""),o.set(n.STORAGE_KEY.IS_LOGINED_BAAS,""),o.set(n.STORAGE_KEY.IS_ANONYMOUS_USER,""),o.set(n.STORAGE_KEY.USERINFO,""),o.set(n.STORAGE_KEY.UID,"")},e._createRequestMethod=function(){e._config.METHOD_MAP_LIST.map(function(e){a.doCreateRequestMethod(e)})},e.auth=r(15),e.ContentGroup=r(19),e.File=r(20),e.FileCategory=r(21),e.GeoPoint=r(8),e.GeoPolygon=r(10),e.invokeFunction=r(13),e.invoke=r(13),e.Query=r(6),e.storage=r(4),e.TableObject=r(22),e.User=r(12)}},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=r(0),s=r(5),f=r(6),l=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=i(this,a(t).call(this)))._contentGroupID=e,r}var r,n,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,s),r=t,(n=[{key:"getContent",value:function(e){var t={richTextID:e};return this._expand&&(t.expand=this._expand),this._keys&&(t.keys=this._keys),this._initQueryParams(),c.getContent(t)}},{key:"find",value:function(){var e=this._handleAllQueryConditions();return e.contentGroupID=this._contentGroupID,this._initQueryParams(),c.getContentList2(e)}},{key:"getCategoryList",value:function(){return c.getContentCategoryList({contentGroupID:this._contentGroupID,limit:100})}},{key:"getCategory",value:function(e){var t=new f;return t.compare("group_id","=",this._contentGroupID),c.getContentCategory({categoryID:e,where:JSON.stringify(t.queryObject)})}}])&&o(r.prototype,n),l&&o(r,l),t}();e.exports=l},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=r(0),s=r(5),f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,a(t).call(this))}var r,n,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,s),r=t,(n=[{key:"upload",value:function(e,t){return c.uploadFile(e,t,"json")}},{key:"delete",value:function(e){return e instanceof Array?c.deleteFiles({id__in:e}):c.deleteFile({fileID:e})}},{key:"get",value:function(e){return c.getFileDetail({fileID:e})}},{key:"find",value:function(){var e=this._handleAllQueryConditions();return this._initQueryParams(),c.getFileList(e)}}])&&o(r.prototype,n),f&&o(r,f),t}();e.exports=f},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=r(0),s=r(5),f=r(6),l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,a(t).call(this))}var r,n,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,s),r=t,(n=[{key:"get",value:function(e){return c.getFileCategoryDetail({categoryID:e})}},{key:"getFileList",value:function(e){var t=new f;return t.in("category_id",[e]),c.getFileList({where:JSON.stringify(t.queryObject)})}},{key:"find",value:function(){var e=this._handleAllQueryConditions();return this._initQueryParams(),c.getFileCategoryList(e)}}])&&o(r.prototype,n),l&&o(r,l),t}();e.exports=l},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e,t,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=r(0),f=r(5),l=r(1),y=r(6),h=r(23),p=r(2),d=r(7),_=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=i(this,u(t).call(this)))._tableID=e,r}var r,n,_;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,f),r=t,(n=[{key:"create",value:function(){return new h(this._tableID)}},{key:"createMany",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).enableTrigger,r=void 0===t||t,n=d._serializeValueFuncFactory(["BaseRecord"]);if(p.isArray(e)){var o={tableID:this._tableID,data:e.map(function(e){return Object.keys(e).forEach(function(t){e[t]=n(e[t])}),e}),enable_trigger:r?1:0};return s.createRecordList(o)}throw new l(605)}},{key:"delete",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).enableTrigger,r=void 0===t||t;if(p.isString(e)||Number.isInteger(e))return s.deleteRecord({tableID:this._tableID,recordID:e});if(e instanceof y){var n={tableID:this._tableID,limit:this._limit,offset:this._offset,where:JSON.stringify(e.queryObject),enable_trigger:r?1:0};return this._initQueryParams(),s.deleteRecordList(n)}throw new l(605)}},{key:"getWithoutData",value:function(e){if(p.isString(e)||Number.isInteger(e))return new h(this._tableID,e);if(e instanceof y){var t={};return t.limit=this._limit,t.offset=this._offset,t.where=p.cloneDeep(e.queryObject),this._initQueryParams(),new h(this._tableID,null,t)}throw new l(605)}},{key:"get",value:function(e){var t={tableID:this._tableID,recordID:e};return this._expand&&(t.expand=this._expand),this._keys&&(t.keys=this._keys),this._initQueryParams(),s.getRecord(t)}},{key:"_handleAllQueryConditions",value:function(){var e=a(u(t.prototype),"_handleAllQueryConditions",this).call(this);return e.tableID=this._tableID,e}},{key:"find",value:function(){var e=this._handleAllQueryConditions();return this._initQueryParams(),s.queryRecordList(e)}},{key:"count",value:function(){return this.limit(1).find().then(function(e){return e.data.meta.total_count})}}])&&o(r.prototype,n),_&&o(r,_),t}();e.exports=_},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=r(0),s=r(7),f=r(2),l=function(e){function t(e,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=i(this,a(t).call(this,r)))._tableID=e,n._queryObject=o,n}var r,n,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,s),r=t,(n=[{key:"save",value:function(){var e=f.cloneDeep(this._record);return this._recordValueInit(),c.createRecord({tableID:this._tableID,data:e.$set})}},{key:"update",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).enableTrigger,t=void 0===e||e,r=f.cloneDeep(this._record);if(this._recordValueInit(),this._recordID)return c.updateRecord({tableID:this._tableID,recordID:this._recordID,data:r});var n={tableID:this._tableID,data:r,where:JSON.stringify(this._queryObject.where),limit:this._queryObject.limit,offset:this._queryObject.offset,enable_trigger:t?1:0};return this._queryObject={},c.updateRecordList(n)}}])&&o(r.prototype,n),l&&o(r,l),t}();e.exports=l},function(e,t,r){var n=r(0),o=r(3),i=r(2);e.exports={getUploadFileConfig:function(e,t){return t.filename=e,n._baasRequest({url:n._polyfill.getAPIHost()+n._config.API.UPLOAD,method:"POST",data:t})},getUploadHeaders:function(){return{Authorization:o.UPLOAD.HEADER_AUTH_VALUE+n.getAuthToken(),"X-Hydrogen-Client-Version":n._config.VERSION,"X-Hydrogen-Client-Platform":i.getSysPlatform(),"X-Hydrogen-Client-ID":n._config.CLIENT_ID,"User-Agent":o.UPLOAD.UA}}}},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(2),i=r(1),a=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Error;return n.code=t,n.message=r?"".concat(t,": ").concat(r):"".concat(t,": ").concat(this.mapErrorMessage(t)),n}var t,r,o;return t=e,(r=[{key:"mapErrorMessage",value:function(e){switch(e){case 11:return"无权跨域";case 12:return"网络出错";case 13:return"超时";case 14:return"解码失败";case 19:return"HTTP 错误";default:return"unknown error"}}}])&&n(t.prototype,r),o&&n(t,o),e}();e.exports=function(e){e.request=function(e){return function(t){var r=t.url,n=t.method,u=void 0===n?"GET":n,c=t.data,s=void 0===c?{}:c,f=t.header,l=void 0===f?{}:f,y=t.headers,h=void 0===y?{}:y,p=t.dataType,d=void 0===p?"json":p,_=e._config;return new Promise(function(t,n){if(!_.CLIENT_ID)return n(new i(602));if(h=o.mergeRequestHeader(Object.assign({"Content-Type":"application/json"},l,h)),"PUT"!==u.toUpperCase()&&"DELETE"!==u.toUpperCase()||(h["X-Hydrogen-Request-Method"]=u,u="POST"),!/https?:\/\//.test(r)){var c=e._config.DEBUG?e._config.API_HOST:e._polyfill.getAPIHost();r=c+r}my.httpRequest({method:u,url:r,data:s,headers:h,dataType:d,success:t,fail:function(e){if(e.status>=200&&e.status<300)return t(e);n(new a(parseInt(e.error),e.errorMessage))}}),o.log("Request => "+r)})}}(e)},e.exports.RequestError=a,e.exports.extractErrorMsg=function(e){var t="";return 404===e.status?t="not found":e.data.error_msg?t=e.data.error_msg:e.data.message&&(t=e.data.message),t}},,,function(e,t,r){var n=r(3),o=r(1),i=function(e){return function(t,i){var a=e._config.API,u=i?a.ALIPAY.AUTHENTICATE:a.ALIPAY.SILENT_LOGIN;return e.request({url:u,method:"POST",data:{code:t}}).then(function(t){if(t.status==n.STATUS_CODE.CREATED)return e.storage.set(n.STORAGE_KEY.UID,t.data.user_id),e.storage.set(n.STORAGE_KEY.ALIPAY_USER_ID,t.data.alipay_user_id||""),e.storage.set(n.STORAGE_KEY.AUTH_TOKEN,t.data.token),e.storage.set(n.STORAGE_KEY.EXPIRES_AT,Math.floor(Date.now()/1e3)+t.data.expires_in-30),t;throw new o(t.statusCode,r(25).extractErrorMsg(t))})}},a=function(e){return function(t,i){var a=e._config.API;return e.request({url:a.ALIPAY.USER_ASSOCIATE,method:"PUT",data:{code:t,authorized:i}}).then(function(t){if(t.status==n.STATUS_CODE.UPDATE)return e.storage.set(n.STORAGE_KEY.ALIPAY_USER_ID,t.data.alipay_user_id||""),t;throw new o(t.statusCode,r(25).extractErrorMsg(t))})}};e.exports=function(e){return function t(r,n){var o=r?"auth_user":"auth_base",u=n?a(e):i(e);return new Promise(function(e,t){my.getAuthCode({scopes:o,success:function(r){r.authCode?e(r.authCode):t(r.authErrorScope)},fail:function(e){return t(e)}})}).catch(function(e){if(e.error&&11===e.error||e.authErrorScope&&e.authErrorScope.scope&&/用户取消授权/.test(e.authErrorScope.scope))return t(!1,n);throw e}).then(function(e){return u(e,r)})}}},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){var n=r(18),o=r(0),i=r(53),a=r(25),u=r(54),c=r(55),s=r(56),f=r(57);o._config.VERSION="v2.0.0",o.use(n),o.use(i),o.use(a),o.use(u),o.use(c),o.use(s),o.use(f),o._createRequestMethod(),my.BaaS=o,e.exports=o},function(e,t,r){var n=r(2),o=r(3),i=r(1),a=r(28),u={silent:null,force:null},c=function(e){return function(t){var r=!!t&&!!t.forceLogin,i=a(e);if(function(e){var t=e.storage.get(o.STORAGE_KEY.UID),r=e.storage.get(o.STORAGE_KEY.AUTH_TOKEN);return!!t&&!!r&&!n.isSessionExpired()}(e))return Promise.resolve();var c=r?"force":"silent";return u[c]?u[c]:(u[c]=i(r).then(function(e){return u[c]=null,e}).catch(function(e){throw u[c]=null,e}),u[c])}},s=function(){throw new i(611)};e.exports=function(e){var t=c(e);e.auth=Object.assign({},e.auth,{silentLogin:t.bind(null,{forceLogin:!1}),loginWithAlipay:function(r){return t(r).then(e.auth.currentUser)},login:s,anonymousLogin:s,requestPasswordReset:s,register:s})}},function(e,t,r){var n=r(3),o=r(2),i=function(e){return function(t){var r=t.url,i=t.method,u=void 0===i?"GET":i,c=t.data,s=void 0===c?{}:c,f=t.header,l=t.headers,y=t.dataType,h=void 0===y?"json":y;return e.auth.silentLogin().then(function(){return e.request({header:f,headers:l,method:u,url:r,data:s,dataType:h})}).then(function(t){return parseInt(t.status)===n.STATUS_CODE.UNAUTHORIZED?a(e,{header:f,headers:l,method:u,url:r,data:s,dataType:h}):o.validateStatusCode(t)})}};function a(e,t){var r=i(e);return e.storage.get(n.STORAGE_KEY.AUTH_TOKEN)&&e.clearSession(),r(t).then(o.validateStatusCode)}e.exports=function(e){e._baasRequest=i(e)}},function(e,t,r){var n=r(1),o=r(3),i=r(2),a=r(28);e.exports=function(e){Object.assign(e._polyfill,{getSystemInfoSync:function(){return my.getSystemInfoSync()},setStorageSync:function(e,t){return my.setStorageSync({key:e,data:t})},getStorageSync:function(e){return my.getStorageSync({key:e}).data},linkAlipay:i.rateLimit(function(t){var r=!!t&&!!t.forceLogin,i=e.storage.get(o.STORAGE_KEY.UID);if(!i)throw new n(604);return a(e)(r,i)}),CLIENT_PLATFORM:"ALIPAY"})}},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(24),a=i.getUploadFileConfig,u=i.getUploadHeaders,c=r(1),s=r(3),f=r(2),l=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Error;return n.code=t,n.message=r?"".concat(t,": ").concat(r):"".concat(t,": ").concat(this.mapErrorMessage(t)),n}var t,r,n;return t=e,(r=[{key:"mapErrorMessage",value:function(e){switch(e){case 11:return"文件不存在";case 12:return"上传文件失败";case 13:return"没有权限";default:return"unknown error"}}}])&&o(t.prototype,r),n&&o(t,n),e}(),y=function(){return function(e,t){if(!e||"object"!==n(e)||!e.filePath)throw new c(605);if(t){if("object"!==n(t))throw new c(605)}else t={};var r,o=null,i=new Promise(function(e,t){r=e,o=t}),y=f.getFileNameFromPath(e.filePath);return a(y,f.replaceQueryParams(t)).then(function(t){!function(e,t,r){my.uploadFile({url:e.uploadUrl,filePath:e.filePath,fileName:s.UPLOAD.UPLOAD_FILE_KEY,fileType:e.fileType,formData:{authorization:e.authorization,policy:e.policy},header:u(),success:function(r){var n={},o=JSON.parse(r.data);n.status="ok",n.path=e.destLink,n.file={id:e.id,name:e.fileName,created_at:o.time,mime_type:o.mimetype,cdn_path:o.url,size:o.file_size},delete r.data,r.data=n,t(r)},fail:function(e){r(new l(parseInt(e.error),e.errorMessage))}})}({id:t.data.id,fileName:y,policy:t.data.policy,authorization:t.data.authorization,uploadUrl:t.data.upload_url,filePath:e.filePath,fileType:e.fileType,destLink:t.data.file_link},function(e){r(e)},o)},o),i}};e.exports=function(e){e.uploadFile=y()},e.exports.UploadError=l},function(e,t){e.exports=function(e){e.pay=function(e){}}}])});
//# sourceMappingURL=sdk-alipay.2.0.0.js.map